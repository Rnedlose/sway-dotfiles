# Make sure systemd --user services inherit the Wayland session env
exec_always systemctl --user import-environment WAYLAND_DISPLAY SWAYSOCK XDG_RUNTIME_DIR DBUS_SESSION_BUS_ADDRESS
exec_always dbus-update-activation-environment --systemd WAYLAND_DISPLAY SWAYSOCK XDG_RUNTIME_DIR DBUS_SESSION_BUS_ADDRESS

# Set common variables
set $mod Mod1
set $left h
set $down j
set $up k
set $right l
set $term alacritty

set $menu "rofi -show drun"
set $browser firefox --new-window
set $lockscreen ~/.config/sway/scripts/lockscreen.sh

# Screenshots
set $screenshot_dir ~/Pictures/Screenshots

# Background changer via swww
set $walls "${HOME}/.config/swww/walls.sh"

# Default Font
font pango:JetBrainsMono Nerd Font Regular 12

# A little eye candy is ok
set $corner_radius 0
gaps inner 4
gaps outer 4
default_border pixel 2
# Class                 border  Backgr  Text    indicator   child_border
client.focused          #7aa2f7 #1a1b26 #c0caf5 #bb9af7     #7aa2f7
client.unfocused        #414868 #24283b #565f89 #414868     #414868
client.urgent           #f7768e #1a1b26 #c0caf5 #f7768e     #f7768e

corner_radius 6
shadows enable
shadows_on_csd enable
shadow_blur_radius 20
shadow_color #0000007F
default_dim_inactive 0.0
dim_inactive_colors.unfocused #000000FF
dim_inactive_colors.urgent #900000FF

# Start essential services
exec_always autotiling
exec waybar
exec wl-paste --watch cliphist store
exec swayidle -w timeout 300 '$lockscreen -f' timeout 600 'swaymsg "output * power off"' resume 'swaymsg "output * power on"' before-sleep '$lockscreen -f'
exec sunsetr
exec $walls
exec --no-startup-id xdg-desktop-portal-gtk

# External monitor (DP-3) - 4K at scale 1.67, positioned at top
output DP-3 resolution 3840x2160 scale 1.67 position 0 0

# Laptop screen (eDP-1) - centered underneath external monitor
output eDP-1 resolution 2880x1920 scale 2.0 position 2299 0

# Laptop touchpad
input type:touchpad {
    dwt enabled
    tap enabled
    natural_scroll false
    middle_emulation enabled
}

# # Swap alt/win and capslock to left control
# input type:keyboard {
#     xkb_options "altwin:swap_lalt_lwin, ctrl:swapcaps"
# }

# Keybinds
bindsym $mod+b exec $browser
bindsym $mod+t exec $term
bindsym $mod+e exec nautilus
bindsym $mod+w kill
bindsym $mod+space exec $menu
bindsym $mod+o exec obsidian
bindsym $mod+s exec spotify
bindsym $mod+d exec discord

# Screenshot an area
bindsym $mod+p exec grimshot save area - | satty --filename - --output-filename $screenshot_dir/satty-$(date +%Y%m%d-%H:%M:%S).png

# Screenshot the whole screen
bindsym $mod+ctrl+p exec grimshot save screen - | satty --filename - --output-filename $screenshot_dir/satty-$(date +%Y%m%d-%H:%M:%S).png

# Screenshot a specific window
bindsym $mod+Super+p exec grimshot save active - | satty --filename - --output-filename $screenshot_dir/satty-$(date +%Y%m%d-%H:%M:%S).png

# Windows
bindsym $mod+backslash exec rofi -show window

# Clipboard manager
bindsym $mod+c exec ~/.config/sway/scripts/clipboard.sh

# Walls
bindsym $mod+u exec $walls

# Lockscreen manually
bindsym $mod+Shift+x exec $lockscreen

# Exit sway (logs you out of your Wayland session)
bindsym $mod+Shift+Space exec swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -B 'Yes, exit sway' 'swaymsg exit'

# Power menu
set $power "rofi -show p -modi p:${HOME}/.config/rofi/rofi-power-menu --symbols-font 'Symbols Nerd Font' -theme tokyo-night-power"
bindsym $mod+Shift+p exec $power

# Volume with swayosd notifications
bindsym XF86AudioRaiseVolume exec swayosd-client --output-volume raise
bindsym XF86AudioLowerVolume exec swayosd-client --output-volume lower  
bindsym XF86AudioMute exec swayosd-client --output-volume mute-toggle
bindsym XF86AudioMicMute exec swayosd-client --input-volume mute-toggle

# Media playerctl
bindsym XF86AudioNext exec playerctl next
bindsym XF86AudioPrev exec playerctl previous
bindsym XF86AudioPlay exec playerctl play-pause

# Backlight with swayosd notifications
bindsym XF86MonBrightnessUp exec swayosd-client --brightness raise
bindsym XF86MonBrightnessDown exec swayosd-client --brightness lower

# Reload config file
bindsym $mod+Shift+c exec "sway reload && notify-send -e 'Config reloaded'  'Sway happy!'"

# Move your focus around
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right

# Move the focused window with the same
bindsym $mod+Super+$left move left
bindsym $mod+Super+$down move down
bindsym $mod+Super+$up move up
bindsym $mod+Super+$right move right

# Switch to workspace
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

# Move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10

# Move focused container to workspace
bindsym $mod+Super+1 move container to workspace number 1, workspace number 1
bindsym $mod+Super+2 move container to workspace number 2, workspace number 2
bindsym $mod+Super+3 move container to workspace number 3, workspace number 3
bindsym $mod+Super+4 move container to workspace number 4, workspace number 4
bindsym $mod+Super+5 move container to workspace number 5, workspace number 5
bindsym $mod+Super+6 move container to workspace number 6, workspace number 6
bindsym $mod+Super+7 move container to workspace number 7, workspace number 7
bindsym $mod+Super+8 move container to workspace number 8, workspace number 8
bindsym $mod+Super+9 move container to workspace number 9, workspace number 9
bindsym $mod+Super+0 move container to workspace number 10, workspace number 10

# Tiling options
bindsym $mod+n splith
bindsym $mod+v splitv

# Fullscrren is nice at times
bindsym $mod+Shift+f fullscreen

# Floating
bindsym $mod+q floating toggle

# Move floating windows
floating_modifier $mod normal

# Resizing
mode "resize" {
    bindsym $left resize shrink width 20px
    bindsym $down resize grow height 20px
    bindsym $up resize shrink height 20px
    bindsym $right resize grow width 20px

    # Return to default mode
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+Shift+r mode "resize"

# Floating window rules
for_window [app_id="Impala"] floating enable, move position center
for_window [app_id="Wiremix"] floating enable, move position center
for_window [app_id="Bluetui"] floating enable, move position center
for_window [app_id="satty"] floating enable, resize set 70 ppt 70 ppt, move position center
for_window [app_id="kitty"] floating enable, resize set 70 ppt 70 ppt, move position center

# clamshell mode
bindswitch lid:on output eDP-1 disable
bindswitch lid:off output eDP-1 enable

include /etc/sway/config.d/*
